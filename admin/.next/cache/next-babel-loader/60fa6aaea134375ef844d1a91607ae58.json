{"ast":null,"code":"var _jsxFileName = \"/Users/draki/Documents/Epitech/EIP/admin/pages/control/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useRef, useEffect, useState } from 'react';\nimport Layout from '../../components/Layout';\nimport API from '../../services/API';\nimport mapboxgl, { accessToken } from \"mapbox-gl\";\nimport AccessTokenService from \"../../services/AccessTokenService\";\nimport UserDataService from \"../../services/UserDataService\";\nmapboxgl.accessToken = 'pk.eyJ1IjoiaGljY3VwLXN0YWZmIiwiYSI6ImNsangxeHVkbzAyNmwzdHJ4cmJiYWZmMm4ifQ.yI4259jlMq2elDiT_uK1kg';\nexport default function Control(access_token, user_data) {\n  const {\n    0: GeoJSON,\n    1: setGeoJson\n  } = useState({});\n  const {\n    0: lng,\n    1: setLng\n  } = useState(2.35);\n  const {\n    0: lat,\n    1: setLat\n  } = useState(48.85);\n  const {\n    0: zoom,\n    1: setZoom\n  } = useState(7);\n  const map = useRef(null);\n  const mapContainer = useRef(null);\n  useEffect(() => {\n    const user_data = UserDataService.get();\n    if (map.current) return; // initialize map only once\n    map.current = new mapboxgl.Map({\n      container: mapContainer.current,\n      style: 'mapbox://styles/mapbox/streets-v12',\n      center: [lng, lat],\n      zoom: zoom\n    });\n    async function fetchGeoJSON(user_data) {\n      try {\n        console.log(user_data);\n        const response = await API.send('POST', '/api/trail/retrieve', user_data, true);\n        let trails = response.data.trails;\n        console.log(trails);\n        trails.map((item, index) => {\n          console.log(\"item : \" + JSON.stringify(item));\n          map.current.addSource('custom-data' + index, {\n            type: 'geojson',\n            data: item.geoJSON\n          });\n          map.current.addLayer({\n            id: index,\n            type: 'symbol',\n            source: 'custom-data' + index,\n            layout: {\n              'icon-image': 'marker-15'\n            }\n          });\n        });\n      } catch (error) {\n        console.error('Error fetching GeoJSON:', error);\n      }\n    }\n    fetchGeoJSON(user_data);\n    map.current.addControl(new mapboxgl.NavigationControl(), \"top-right\");\n    return () => {\n      map.current.remove();\n    };\n  });\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  }, __jsx(_JSXStyle, {\n    id: \"855806535\",\n    __self: this\n  }, \".map-container.jsx-855806535{position:absolute;width:100%;height:100%;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kcmFraS9Eb2N1bWVudHMvRXBpdGVjaC9FSVAvYWRtaW4vcGFnZXMvY29udHJvbC9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUErRDRCLEFBRzJDLGtCQUNQLFdBQ0MsWUFDaEIiLCJmaWxlIjoiL1VzZXJzL2RyYWtpL0RvY3VtZW50cy9FcGl0ZWNoL0VJUC9hZG1pbi9wYWdlcy9jb250cm9sL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZVJlZiwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBMYXlvdXQgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9MYXlvdXQnO1xuaW1wb3J0IEFQSSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9BUEknO1xuaW1wb3J0IG1hcGJveGdsLCB7IGFjY2Vzc1Rva2VuIH0gZnJvbSBcIm1hcGJveC1nbFwiO1xuaW1wb3J0IEFjY2Vzc1Rva2VuU2VydmljZSBmcm9tIFwiLi4vLi4vc2VydmljZXMvQWNjZXNzVG9rZW5TZXJ2aWNlXCI7XG5pbXBvcnQgVXNlckRhdGFTZXJ2aWNlIGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9Vc2VyRGF0YVNlcnZpY2VcIjtcblxubWFwYm94Z2wuYWNjZXNzVG9rZW4gPSAncGsuZXlKMUlqb2lhR2xqWTNWd0xYTjBZV1ptSWl3aVlTSTZJbU5zYW5neGVIVmtiekF5Tm13emRISjRjbUppWVdabU1tNGlmUS55STQyNTlqbE1xMmVsRGlUX3VLMWtnJztcblxuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbnRyb2wgKGFjY2Vzc190b2tlbiwgdXNlcl9kYXRhKSB7XG4gIFxuICAgIGNvbnN0IFtHZW9KU09OLCBzZXRHZW9Kc29uXSA9IHVzZVN0YXRlKHt9KTtcbiAgICBjb25zdCBbbG5nLCBzZXRMbmddID0gdXNlU3RhdGUoMi4zNSk7XG4gICAgY29uc3QgW2xhdCwgc2V0TGF0XSA9IHVzZVN0YXRlKDQ4Ljg1KTtcbiAgICBjb25zdCBbem9vbSwgc2V0Wm9vbV0gPSB1c2VTdGF0ZSg3KTtcbiAgICBjb25zdCBtYXAgPSB1c2VSZWYobnVsbCk7XG4gICAgY29uc3QgbWFwQ29udGFpbmVyID0gdXNlUmVmKG51bGwpO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3QgdXNlcl9kYXRhID0gVXNlckRhdGFTZXJ2aWNlLmdldCgpO1xuICAgICAgICBpZiAobWFwLmN1cnJlbnQpIHJldHVybjsgLy8gaW5pdGlhbGl6ZSBtYXAgb25seSBvbmNlXG4gICAgICAgIG1hcC5jdXJyZW50ID0gbmV3IG1hcGJveGdsLk1hcCh7XG4gICAgICAgIGNvbnRhaW5lcjogbWFwQ29udGFpbmVyLmN1cnJlbnQsXG4gICAgICAgIHN0eWxlOiAnbWFwYm94Oi8vc3R5bGVzL21hcGJveC9zdHJlZXRzLXYxMicsXG4gICAgICAgIGNlbnRlcjogW2xuZywgbGF0XSxcbiAgICAgICAgem9vbTogem9vbVxuICAgICAgICB9KTtcblxuICAgICAgICBhc3luYyBmdW5jdGlvbiBmZXRjaEdlb0pTT04odXNlcl9kYXRhKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyX2RhdGEpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgQVBJLnNlbmQoJ1BPU1QnLCAnL2FwaS90cmFpbC9yZXRyaWV2ZScsIHVzZXJfZGF0YSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICBsZXQgdHJhaWxzID0gcmVzcG9uc2UuZGF0YS50cmFpbHM7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0cmFpbHMpO1xuICAgICAgICAgICAgICAgICAgdHJhaWxzLm1hcCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpdGVtIDogXCIgKyBKU09OLnN0cmluZ2lmeShpdGVtKSk7XG4gICAgICAgICAgICAgICAgICAgIG1hcC5jdXJyZW50LmFkZFNvdXJjZSgnY3VzdG9tLWRhdGEnICsgaW5kZXgsIHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZ2VvanNvbicsXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YTogaXRlbS5nZW9KU09OLFxuICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgIG1hcC5jdXJyZW50LmFkZExheWVyKHtcbiAgICAgICAgICAgICAgICAgICAgICBpZDogaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N5bWJvbCcsXG4gICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnY3VzdG9tLWRhdGEnICsgaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgbGF5b3V0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaWNvbi1pbWFnZSc6ICdtYXJrZXItMTUnLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBHZW9KU09OOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmV0Y2hHZW9KU09OKHVzZXJfZGF0YSk7XG4gICAgICAgICAgICBtYXAuY3VycmVudC5hZGRDb250cm9sKG5ldyBtYXBib3hnbC5OYXZpZ2F0aW9uQ29udHJvbCgpLCBcInRvcC1yaWdodFwiKTtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7IG1hcC5jdXJyZW50LnJlbW92ZSgpfTtcbiAgICAgIH0pO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPExheW91dD5cbiAgICAgICAgICAgICAgICA8c3R5bGUganN4PntgXG4gICAgICAgICAgICAgICAgICAgIC5tYXAtY29udGFpbmVyIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGB9PC9zdHlsZT5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiByZWY9e21hcENvbnRhaW5lcn0gY2xhc3NOYW1lPVwibWFwLWNvbnRhaW5lclwiLz5cbiAgICAgICAgICAgIDx0aXRsZT5IaWsnVVAgQWRtaW48L3RpdGxlPlxuICAgICAgICA8L0xheW91dD5cbiAgICApO1xufSJdfQ== */\\n/*@ sourceURL=/Users/draki/Documents/Epitech/EIP/admin/pages/control/index.js */\"), __jsx(\"div\", {\n    ref: mapContainer,\n    className: \"jsx-855806535\" + \" \" + \"map-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 21\n    }\n  }), __jsx(\"title\", {\n    className: \"jsx-855806535\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }\n  }, \"Hik'UP Admin\"));\n}","map":{"version":3,"names":["React","useRef","useEffect","useState","Layout","API","mapboxgl","accessToken","AccessTokenService","UserDataService","Control","access_token","user_data","GeoJSON","setGeoJson","lng","setLng","lat","setLat","zoom","setZoom","map","mapContainer","get","current","Map","container","style","center","fetchGeoJSON","console","log","response","send","trails","data","item","index","JSON","stringify","addSource","type","geoJSON","addLayer","id","source","layout","error","addControl","NavigationControl","remove","__jsx","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","_JSXStyle","ref","className"],"sources":["/Users/draki/Documents/Epitech/EIP/admin/pages/control/index.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport Layout from '../../components/Layout';\nimport API from '../../services/API';\nimport mapboxgl, { accessToken } from \"mapbox-gl\";\nimport AccessTokenService from \"../../services/AccessTokenService\";\nimport UserDataService from \"../../services/UserDataService\";\n\nmapboxgl.accessToken = 'pk.eyJ1IjoiaGljY3VwLXN0YWZmIiwiYSI6ImNsangxeHVkbzAyNmwzdHJ4cmJiYWZmMm4ifQ.yI4259jlMq2elDiT_uK1kg';\n\n\n\nexport default function Control (access_token, user_data) {\n  \n    const [GeoJSON, setGeoJson] = useState({});\n    const [lng, setLng] = useState(2.35);\n    const [lat, setLat] = useState(48.85);\n    const [zoom, setZoom] = useState(7);\n    const map = useRef(null);\n    const mapContainer = useRef(null);\n\n    useEffect(() => {\n        const user_data = UserDataService.get();\n        if (map.current) return; // initialize map only once\n        map.current = new mapboxgl.Map({\n        container: mapContainer.current,\n        style: 'mapbox://styles/mapbox/streets-v12',\n        center: [lng, lat],\n        zoom: zoom\n        });\n\n        async function fetchGeoJSON(user_data) {\n            try {\n              console.log(user_data);\n                const response = await API.send('POST', '/api/trail/retrieve', user_data, true);\n                  let trails = response.data.trails;\n                  console.log(trails);\n                  trails.map((item, index) => {\n                    console.log(\"item : \" + JSON.stringify(item));\n                    map.current.addSource('custom-data' + index, {\n                      type: 'geojson',\n                      data: item.geoJSON,\n                    })\n\n                    map.current.addLayer({\n                      id: index,\n                      type: 'symbol',\n                      source: 'custom-data' + index,\n                      layout: {\n                        'icon-image': 'marker-15',\n                      },\n                    });\n                  });\n              } catch (error) {\n                  console.error('Error fetching GeoJSON:', error);\n              }\n            }\n            fetchGeoJSON(user_data);\n            map.current.addControl(new mapboxgl.NavigationControl(), \"top-right\");\n            return () => { map.current.remove()};\n      });\n\n    return (\n        <Layout>\n                <style jsx>{`\n                    .map-container {\n                        position: absolute;\n                        width: 100%;\n                        height: 100%;\n                    }\n                    `}</style>\n                    <div ref={mapContainer} className=\"map-container\"/>\n            <title>Hik'UP Admin</title>\n        </Layout>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}
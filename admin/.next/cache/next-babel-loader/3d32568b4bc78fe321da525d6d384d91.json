{"ast":null,"code":"var _jsxFileName = \"/Users/draki/Documents/Epitech/EIP/admin/pages/index.js\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport Router from 'next/router';\nimport { Card, Alert, Input, Button, Layout } from 'antd';\nimport API from '../services/API';\nimport AccessTokenService from \"../services/AccessTokenService\";\nimport UserDataService from \"../services/AccessTokenService\";\nconst Login = () => {\n  useEffect(() => {\n    const token = AccessTokenService.get();\n    if (token) Router.push('/control');\n  });\n  const {\n    0: email,\n    1: setEmail\n  } = useState(\"\");\n  const {\n    0: password,\n    1: setPassword\n  } = useState(\"\");\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(null);\n  const submit = async () => {\n    const data = {\n      email,\n      password\n    };\n    setError(null);\n    setLoading(true);\n    const response = await API.send('POST', '/api/auth/login', data, false);\n    //const rslt = JSON.parse(response);\n    setLoading(false);\n    if (response.status === 200) {\n      const data = JSON.parse(response);\n      console.log(\"access_token : \" + response.data.user.token);\n      AccessTokenService.set(data.user.token);\n      console.log(response.data.user);\n      UserDataService.set(response.data.user);\n      await Router.push('/control');\n    } else if (response.status === 401) setError(\"Bad credentials\");else setError(\"An error occurred\");\n  };\n  return __jsx(Layout, {\n    style: {\n      height: \"100vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  }, __jsx(Card, {\n    style: {\n      width: 400,\n      backgroundColor: \"#fff\",\n      margin: \"auto\",\n      textAlign: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }\n  }, error && __jsx(Alert, {\n    style: {\n      marginBottom: 30\n    },\n    message: error,\n    type: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 21\n    }\n  }), __jsx(Input, {\n    placeholder: \"Email\",\n    value: email,\n    onChange: event => setEmail(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 17\n    }\n  }), __jsx(Input, {\n    style: {\n      marginTop: 15\n    },\n    placeholder: \"Password\",\n    value: password,\n    type: \"password\",\n    onChange: event => setPassword(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 17\n    }\n  }), __jsx(Button, {\n    type: \"primary\",\n    onClick: submit,\n    loading: loading,\n    style: {\n      marginTop: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 17\n    }\n  }, \"Submit\")));\n};\nexport default Login;","map":{"version":3,"names":["React","useEffect","useState","Router","Card","Alert","Input","Button","Layout","API","AccessTokenService","UserDataService","Login","token","get","push","email","setEmail","password","setPassword","loading","setLoading","error","setError","submit","data","response","send","status","JSON","parse","console","log","user","set","__jsx","style","height","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","width","backgroundColor","margin","textAlign","marginBottom","message","type","placeholder","value","onChange","event","target","marginTop","onClick"],"sources":["/Users/draki/Documents/Epitech/EIP/admin/pages/index.js"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport Router from 'next/router';\nimport {Card, Alert, Input, Button, Layout} from 'antd';\nimport API from '../services/API';\nimport AccessTokenService from \"../services/AccessTokenService\";\nimport UserDataService from \"../services/AccessTokenService\";\n\n\nconst Login = () => {\n    useEffect(() => {\n        const token = AccessTokenService.get();\n        if (token)\n            Router.push('/control');\n    });\n\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState(null);\n\n    const submit = async () => {\n        const data = {\n            email,\n            password,\n        }\n        setError(null);\n        setLoading(true);\n        const response = await API.send('POST', '/api/auth/login', data, false);\n        //const rslt = JSON.parse(response);\n        setLoading(false);\n\n        if (response.status === 200) {\n            const data = JSON.parse(response);\n            console.log(\"access_token : \" + response.data.user.token);\n            AccessTokenService.set(data.user.token);\n            console.log(response.data.user);\n            UserDataService.set(response.data.user);\n            await Router.push('/control');\n        } else if (response.status === 401)\n            setError(\"Bad credentials\");\n        else\n            setError(\"An error occurred\");\n    }\n\n    return (\n        <Layout style={{height: \"100vh\"}}>\n            <Card style={{width: 400, backgroundColor: \"#fff\", margin: \"auto\", textAlign: \"center\"}}>\n                {error && (\n                    <Alert style={{marginBottom: 30}} message={error} type=\"error\" />\n                )}\n                <Input\n                    placeholder={\"Email\"}\n                    value={email}\n                    onChange={(event) => setEmail(event.target.value)}\n                />\n                <Input\n                    style={{marginTop: 15}}\n                    placeholder={\"Password\"}\n                    value={password}\n                    type={\"password\"}\n                    onChange={(event) => setPassword(event.target.value)}\n                />\n                <Button\n                    type={\"primary\"}\n                    onClick={submit}\n                    loading={loading}\n                    style={{marginTop: 20}}\n                >\n                    Submit\n                </Button>\n            </Card>\n        </Layout>\n    );\n}\n\nexport default Login\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}